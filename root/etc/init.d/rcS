#!/bin/sh
PATH=/sbin:/bin
rm -f /var/run/*.pid
echo "Setting hostname"
hostname -F /etc/hostname
echo "Mounting anything"
mount -a
echo "Starting inetd"
inetd
echo "Loading modules"
depmod -a
modprobe rtc
modprobe info
. /proc/bus/dbox.sh
echo "mID: $mID"
echo "feID: $feID"
echo "fpID: $fpID"
echo "enxID: $enxID"
echo "gtxID: $gtxID"
echo "hwREV: $hwREV"
echo "fpREV: $fpREV"
echo "DEMOD: $DEMOD"

modprobe saa7126
modprobe input
modprobe keybdev
modprobe mousedev
modprobe joydev
modprobe evdev
modprobe dvb_frontend
modprobe dvb
modprobe tuner
modprobe graphic
modprobe lcd

echo "Starting loopback device"
ifconfig lo 127.0.0.1 up
# it must be tuned to a valid ts for dvbtime
export TZ=CET-01CEST-02,J84,J302
lcdmenu
RC="$?"
test "$RC" -eq 0 && /etc/init.d/start_enigma
test "$RC" -eq 1 && /etc/init.d/start_neutrino
test "$RC" -eq 2 && /etc/init.d/start_lcars
exit 0
