diff -Naur busybox-1.01.orig/debian/config-deb busybox-1.01/debian/config-deb
--- busybox-1.01.orig/debian/config-deb	2005-08-17 03:29:09.000000000 +0200
+++ busybox-1.01/debian/config-deb	2006-03-01 18:04:55.000000000 +0100
@@ -249,7 +249,7 @@
 # CONFIG_MT is not set
 # CONFIG_STRINGS is not set
 # CONFIG_TIME is not set
-# CONFIG_WATCHDOG is not set
+# CONFIG_BBOX_WATCHDOG is not set
 
 #
 # Linux Module Utilities
diff -Naur busybox-1.01.orig/debian/config-floppy-udeb-linux busybox-1.01/debian/config-floppy-udeb-linux
--- busybox-1.01.orig/debian/config-floppy-udeb-linux	2005-08-17 03:29:09.000000000 +0200
+++ busybox-1.01/debian/config-floppy-udeb-linux	2006-03-01 18:04:56.000000000 +0100
@@ -213,7 +213,7 @@
 # CONFIG_MT is not set
 # CONFIG_STRINGS is not set
 # CONFIG_TIME is not set
-# CONFIG_WATCHDOG is not set
+# CONFIG_BBOX_WATCHDOG is not set
 
 #
 # Linux Module Utilities
diff -Naur busybox-1.01.orig/debian/config-static busybox-1.01/debian/config-static
--- busybox-1.01.orig/debian/config-static	2005-08-17 03:29:09.000000000 +0200
+++ busybox-1.01/debian/config-static	2006-03-01 18:04:56.000000000 +0100
@@ -287,7 +287,7 @@
 CONFIG_MT=y
 CONFIG_STRINGS=y
 CONFIG_TIME=y
-CONFIG_WATCHDOG=y
+CONFIG_BBOX_WATCHDOG=y
 
 #
 # Linux Module Utilities
diff -Naur busybox-1.01.orig/debian/config-udeb busybox-1.01/debian/config-udeb
--- busybox-1.01.orig/debian/config-udeb	2005-08-17 03:29:09.000000000 +0200
+++ busybox-1.01/debian/config-udeb	2006-03-01 18:04:56.000000000 +0100
@@ -252,7 +252,7 @@
 # CONFIG_MT is not set
 # CONFIG_STRINGS is not set
 # CONFIG_TIME is not set
-# CONFIG_WATCHDOG is not set
+# CONFIG_BBOX_WATCHDOG is not set
 
 #
 # Linux Module Utilities
diff -Naur busybox-1.01.orig/debian/config-udeb-linux busybox-1.01/debian/config-udeb-linux
--- busybox-1.01.orig/debian/config-udeb-linux	2005-08-17 03:29:09.000000000 +0200
+++ busybox-1.01/debian/config-udeb-linux	2006-03-01 18:04:56.000000000 +0100
@@ -252,7 +252,7 @@
 # CONFIG_MT is not set
 # CONFIG_STRINGS is not set
 # CONFIG_TIME is not set
-# CONFIG_WATCHDOG is not set
+# CONFIG_BBOX_WATCHDOG is not set
 
 #
 # Linux Module Utilities
diff -Naur busybox-1.01.orig/editors/vi.c busybox-1.01/editors/vi.c
--- busybox-1.01.orig/editors/vi.c	2005-08-17 03:29:16.000000000 +0200
+++ busybox-1.01/editors/vi.c	2006-03-01 18:01:39.000000000 +0100
@@ -19,7 +19,7 @@
  */
 
 static const char vi_Version[] =
-	"$Id: vi.c,v 1.38 2004/08/19 19:15:06 andersen Exp $";
+	"$Id: vi.c,v 1.35 2004/03/31 11:12:51 andersen Exp $";
 
 /*
  * To compile for standalone use:
@@ -344,7 +344,6 @@
 #endif							/* CONFIG_FEATURE_VI_CRASHME */
 
 	status_buffer = STATUS_BUFFER;
-	*status_buffer = '\0';	// clear status buffer
 
 #ifdef CONFIG_FEATURE_VI_READONLY
 	vi_readonly = readonly = FALSE;
@@ -463,6 +462,7 @@
 	last_forward_char = last_input_char = '\0';
 	crow = 0;
 	ccol = 0;
+	edit_status();
 
 #ifdef CONFIG_FEATURE_VI_USE_SIGNALS
 	catch_sig(0);
@@ -506,7 +506,6 @@
 	adding2q = 0;
 #endif							/* CONFIG_FEATURE_VI_DOT_CMD */
 	redraw(FALSE);			// dont force every col re-draw
-	edit_status();
 	show_status_line();
 
 	//------This is the main Vi cmd handling loop -----------------------
@@ -872,7 +871,6 @@
 		} else {
 			// user wants file status info
 			edit_status();
-			show_status_line();
 		}
 	} else if (strncasecmp((char *) cmd, "features", i) == 0) {	// what features are available
 		// print out values of all features
@@ -1335,30 +1333,22 @@
 {
 	if (dot > text && dot[-1] != '\n')
 		dot--;
-	edit_status();			// show current file status
-	show_status_line();
 }
 
 static void dot_right(void)
 {
 	if (dot < end - 1 && *dot != '\n')
 		dot++;
-	edit_status();			// show current file status
-	show_status_line();
 }
 
 static void dot_begin(void)
 {
 	dot = begin_line(dot);	// return pointer to first char cur line
-	edit_status();			// show current file status
-	show_status_line();
 }
 
 static void dot_end(void)
 {
 	dot = end_line(dot);	// return pointer to last char cur line
-	edit_status();			// show current file status
-	show_status_line();
 }
 
 static Byte *move_to_col(Byte * p, int l)
@@ -1383,15 +1373,11 @@
 static void dot_next(void)
 {
 	dot = next_line(dot);
-	edit_status();			// show current file status
-	show_status_line();
 }
 
 static void dot_prev(void)
 {
 	dot = prev_line(dot);
-	edit_status();			// show current file status
-	show_status_line();
 }
 
 static void dot_scroll(int cnt, int dir)
@@ -1416,8 +1402,6 @@
 	if (dot > q)
 		dot = begin_line(q);	// is dot is below bottom line?
 	dot_skip_over_ws();
-	edit_status();			// show current file status
-	show_status_line();
 }
 
 static void dot_skip_over_ws(void)
@@ -1608,11 +1592,11 @@
 		cmd_mode = 0;
 		cmdcnt = 0;
 		end_cmd_q();	// stop adding to q
-		*status_buffer = '\0';  // clear the status buffer
+		strcpy((char *) status_buffer, " ");	// clear the status buffer
 		if ((p[-1] != '\n') && (dot>text)) {
 			p--;
 		}
-	} else if (c == erase_char || c == 8 || c == 127) { // Is this a BS
+	} else if (c == erase_char) {	// Is this a BS
 		//     123456789
 		if ((p[-1] != '\n') && (dot>text)) {
 			p--;
@@ -2356,7 +2340,7 @@
 }
 
 //----- IO Routines --------------------------------------------
-static Byte get_one_char(void)
+static Byte get_one_char()
 {
 	static Byte c;
 
@@ -2616,25 +2600,25 @@
 }
 
 //----- Erase from cursor to end of line -----------------------
-static void clear_to_eol(void)
+static void clear_to_eol()
 {
 	write1(Ceol);   // Erase from cursor to end of line
 }
 
 //----- Erase from cursor to end of screen -----------------------
-static void clear_to_eos(void)
+static void clear_to_eos()
 {
 	write1(Ceos);   // Erase from cursor to end of screen
 }
 
 //----- Start standout mode ------------------------------------
-static void standout_start(void) // send "start reverse video" sequence
+static void standout_start() // send "start reverse video" sequence
 {
 	write1(SOs);     // Start reverse video mode
 }
 
 //----- End standout mode --------------------------------------
-static void standout_end(void) // send "end reverse video" sequence
+static void standout_end() // send "end reverse video" sequence
 {
 	write1(SOn);     // End reverse video mode
 }
@@ -2664,7 +2648,7 @@
 
 //----- Screen[] Routines --------------------------------------
 //----- Erase the Screen[] memory ------------------------------
-static void screen_erase(void)
+static void screen_erase()
 {
 	memset(screen, ' ', screensize);	// clear new screen
 }
@@ -2675,7 +2659,7 @@
 	static int last_cksum;
 	int l, cnt, cksum;
 
-	//edit_status();
+	edit_status();
 	cnt = strlen((char *) status_buffer);
 	for (cksum= l= 0; l < cnt; l++) { cksum += (int)(status_buffer[l]); }
 	// don't write the status line unless it changes
@@ -2697,10 +2681,10 @@
 
 	va_start(args, format);
 	strcpy((char *) status_buffer, SOs);	// Terminal standout mode on
-	vsprintf((char *) status_buffer + strlen((char *) status_buffer), format, args);
+	vsprintf((char *) status_buffer + strlen((char *) status_buffer), format,
+			 args);
 	strcat((char *) status_buffer, SOn);	// Terminal standout mode off
 	va_end(args);
-	show_status_line();
 
 	return;
 }
@@ -2713,7 +2697,6 @@
 	va_start(args, format);
 	vsprintf((char *) status_buffer, format, args);
 	va_end(args);
-	show_status_line();
 	return;
 }
 
@@ -2740,19 +2723,17 @@
 		cur = tot = 0;
 		percent = 100;
 	}
-
-	sprintf((char *) status_buffer,
-			"\"%s\""
+	psb("\"%s\""
 #ifdef CONFIG_FEATURE_VI_READONLY
-			"%s"
+		"%s"
 #endif							/* CONFIG_FEATURE_VI_READONLY */
-			"%s line %d of %d --%d%%--",
-			(cfn != 0 ? (char *) cfn : "No file"),
+		"%s line %d of %d --%d%%--",
+		(cfn != 0 ? (char *) cfn : "No file"),
 #ifdef CONFIG_FEATURE_VI_READONLY
-			((vi_readonly || readonly) ? " [Read only]" : ""),
+		((vi_readonly || readonly) ? " [Read only]" : ""),
 #endif							/* CONFIG_FEATURE_VI_READONLY */
-			(file_modified ? " [modified]" : ""),
-			cur, tot, percent);
+		(file_modified ? " [modified]" : ""),
+		cur, tot, percent);
 }
 
 //----- Force refresh of all Lines -----------------------------
@@ -2898,8 +2879,6 @@
 #endif							/* CONFIG_FEATURE_VI_OPTIMIZE_CURSOR */
 			}
 
-			edit_status();			// show current file status
-			show_status_line();
 			// write line out to terminal
 			{
 				int nic = ce-cs+1;
@@ -3079,18 +3058,15 @@
 		break;
 	case 7:			// ctrl-G  show current status
 		edit_status();
-		show_status_line();
 		break;
 	case 'h':			// h- move left
 	case VI_K_LEFT:	// cursor key Left
-	case 8:		// ctrl-H- move left    (This may be ERASE char)
-	case 127:	// DEL- move left   (This may be ERASE char)
+	case 8:			// ctrl-H- move left    (This may be ERASE char)
+	case 127:			// DEL- move left   (This may be ERASE char)
 		if (cmdcnt-- > 1) {
 			do_cmd(c);
 		}				// repeat cnt
 		dot_left();
-		edit_status();			// show current file status
-		show_status_line();
 		break;
 	case 10:			// Newline ^J
 	case 'j':			// j- goto next line, same col
@@ -3249,7 +3225,7 @@
 		//
 		// dont separate these two commands. 'f' depends on ';'
 		//
-		//**** fall thru to ... ';'
+		//**** fall thru to ... 'i'
 	case ';':			// ;- look at rest of line for last forward char
 		if (cmdcnt-- > 1) {
 			do_cmd(';');
@@ -3407,7 +3383,6 @@
 			}
 		} else if (strncasecmp((char *) p, "file", cnt) == 0 ) {
 			edit_status();			// show current file status
-			show_status_line();
 		} else if (sscanf((char *) p, "%d", &j) > 0) {
 			dot = find_line(j);		// go to line # j
 			dot_skip_over_ws();
@@ -3517,7 +3492,6 @@
 		dot_end();		// move to NL
 		if (dot < end - 1) {	// make sure not last char in text[]
 			*dot++ = ' ';	// replace NL with space
-			file_modified = TRUE;
 			while (isblnk(*dot)) {	// delete leading WS
 				dot_delete();
 			}
diff -Naur busybox-1.01.orig/include/applets.h busybox-1.01/include/applets.h
--- busybox-1.01.orig/include/applets.h	2005-08-17 03:29:15.000000000 +0200
+++ busybox-1.01/include/applets.h	2006-03-01 18:04:56.000000000 +0100
@@ -547,7 +547,7 @@
 #ifdef CONFIG_SYNC
 	APPLET(sync, sync_main, _BB_DIR_BIN, _BB_SUID_NEVER)
 #endif
-#ifdef CONFIG_SYSCTL
+#ifdef CONFIG_BBOX_SYSCTL
 	APPLET(sysctl, sysctl_main, _BB_DIR_SBIN, _BB_SUID_NEVER)
 #endif
 #ifdef CONFIG_SYSLOGD
@@ -643,7 +643,7 @@
 #ifdef CONFIG_WATCH
 	APPLET(watch, watch_main, _BB_DIR_BIN, _BB_SUID_NEVER)
 #endif
-#ifdef CONFIG_WATCHDOG
+#ifdef CONFIG_BBOX_WATCHDOG
 	APPLET(watchdog, watchdog_main, _BB_DIR_SBIN, _BB_SUID_NEVER)
 #endif
 #ifdef CONFIG_WC
diff -Naur busybox-1.01.orig/include/usage.h busybox-1.01/include/usage.h
--- busybox-1.01.orig/include/usage.h	2005-08-17 03:29:15.000000000 +0200
+++ busybox-1.01/include/usage.h	2006-03-01 18:04:55.000000000 +0100
@@ -2302,7 +2302,7 @@
   #define USAGE_IPC_LOG(a)
 #endif
 
-#ifdef CONFIG_SYSCTL
+#ifdef CONFIG_BBOX_SYSCTL
 #define sysctl_trivial_usage \
 	"[OPTIONS]... [VALUE]...\n"
 #define sysctl_full_usage
diff -Naur busybox-1.01.orig/init/init.c busybox-1.01/init/init.c
--- busybox-1.01.orig/init/init.c	2005-08-17 03:29:16.000000000 +0200
+++ busybox-1.01/init/init.c	2006-03-01 18:01:39.000000000 +0100
@@ -375,7 +375,7 @@
 	while ((fd = open(console, O_RDONLY | O_NONBLOCK)) < 0 && tried < 2) {
 		/* Can't open selected console -- try
 			logical system console and VT_MASTER */
-		safe_strncpy(console, (tried == 0 ? _PATH_CONSOLE : CURRENT_VC),
+		safe_strncpy(console, (tried == 0 ? _PATH_CONSOLE : "/dev/tty0"),
 							sizeof(console));
 		tried++;
 	}
@@ -632,15 +632,12 @@
 
 	pid = run(a);
 	while (1) {
-		wpid = waitpid(pid,&status,0);
+		wpid = wait(&status);
+		if (wpid > 0 && wpid != pid) {
+			continue;
+		}	
 		if (wpid == pid)
 			break;
-		if (wpid == -1 && errno == ECHILD) {
-			/* we missed its termination */
-			break;
-		}
-		/* FIXME other errors should maybe trigger an error, but allow
-		 * the program to continue */
 	}
 	return wpid;
 }
diff -Naur busybox-1.01.orig/libbb/messages.c busybox-1.01/libbb/messages.c
--- busybox-1.01.orig/libbb/messages.c	2005-08-17 03:29:14.000000000 +0200
+++ busybox-1.01/libbb/messages.c	2006-03-01 18:01:39.000000000 +0100
@@ -59,27 +59,47 @@
 #endif
 
 #ifdef L_passwd_file
-#define PASSWD_FILE        "/etc/passwd"
+#ifdef CONFIG_AUTH_IN_VAR_ETC
+ #define PASSWD_FILE        "/var/etc/passwd"
+#else
+ #define PASSWD_FILE        "/etc/passwd"
+#endif
 const char * const bb_path_passwd_file = PASSWD_FILE;
 #endif
 
 #ifdef L_shadow_file
-#define SHADOW_FILE        "/etc/shadow"
+#ifdef CONFIG_AUTH_IN_VAR_ETC
+ #define SHADOW_FILE        "/var/etc/shadow"
+#else
+ #define SHADOW_FILE        "/etc/shadow"
+#endif
 const char * const bb_path_shadow_file = SHADOW_FILE;
 #endif
 
 #ifdef L_group_file
-#define GROUP_FILE         "/etc/group"
+#ifdef CONFIG_AUTH_IN_VAR_ETC
+ #define GROUP_FILE         "/var/etc/group"
+#else
+ #define GROUP_FILE         "/etc/group"
+#endif
 const char * const bb_path_group_file = GROUP_FILE;
 #endif
 
 #ifdef L_gshadow_file
-#define GSHADOW_FILE       "/etc/gshadow"
+#ifdef CONFIG_AUTH_IN_VAR_ETC
+ #define GSHADOW_FILE       "/var/etc/gshadow"
+#else
+ #define GSHADOW_FILE       "/etc/gshadow"
+#endif
 const char * const bb_path_gshadow_file = GSHADOW_FILE;
 #endif
 
 #ifdef L_nologin_file
-#define NOLOGIN_FILE       "/etc/nologin"
+#ifdef CONFIG_AUTH_IN_VAR_ETC
+ #define NOLOGIN_FILE       "/var/etc/nologin"
+#else
+ #define NOLOGIN_FILE       "/etc/nologin"
+#endif
 const char * const bb_path_nologin_file = NOLOGIN_FILE;
 #endif
 
diff -Naur busybox-1.01.orig/miscutils/Config.in busybox-1.01/miscutils/Config.in
--- busybox-1.01.orig/miscutils/Config.in	2005-08-17 03:29:15.000000000 +0200
+++ busybox-1.01/miscutils/Config.in	2006-03-01 18:04:56.000000000 +0100
@@ -187,7 +187,7 @@
 	  When the command finishes, time writes a message to standard output
 	  giving timing statistics about this program run.
 
-config CONFIG_WATCHDOG
+config CONFIG_BBOX_WATCHDOG
 	bool "watchdog"
 	default n
 	help
diff -Naur busybox-1.01.orig/miscutils/Makefile.in busybox-1.01/miscutils/Makefile.in
--- busybox-1.01.orig/miscutils/Makefile.in	2005-08-17 03:29:15.000000000 +0200
+++ busybox-1.01/miscutils/Makefile.in	2006-03-01 18:04:56.000000000 +0100
@@ -36,7 +36,7 @@
 MISCUTILS-$(CONFIG_RX)			+= rx.o
 MISCUTILS-$(CONFIG_STRINGS)		+= strings.o
 MISCUTILS-$(CONFIG_TIME)		+= time.o
-MISCUTILS-$(CONFIG_WATCHDOG)		+= watchdog.o
+MISCUTILS-$(CONFIG_BBOX_WATCHDOG)		+= watchdog.o
 
 libraries-y+=$(MISCUTILS_DIR)$(MISCUTILS_AR)
 
diff -Naur busybox-1.01.orig/networking/ifupdown.c busybox-1.01/networking/ifupdown.c
--- busybox-1.01.orig/networking/ifupdown.c	2005-08-17 03:29:10.000000000 +0200
+++ busybox-1.01/networking/ifupdown.c	2006-03-01 18:01:39.000000000 +0100
@@ -1023,7 +1023,7 @@
 
 static int execute_all(struct interface_defn_t *ifd, execfn *exec, const char *opt)
 {
-	int i;
+	int i, fd;
 	char *buf;
 	for (i = 0; i < ifd->n_options; i++) {
 		if (strcmp(ifd->option[i].name, opt) == 0) {
@@ -1032,10 +1032,11 @@
 			}
 		}
 	}
-
-	bb_xasprintf(&buf, "run-parts /etc/network/if-%s.d", opt);
-	if ((*exec)(buf) != 1) {
-		return 0;
+	bb_xasprintf(&buf, "/etc/network/if-%s.d", opt);
+	if ((fd = open(buf, O_RDONLY)) >= 0) {
+	        close(fd);
+                bb_xasprintf(&buf, "run-parts /etc/network/if-%s.d", opt);
+	        (*exec)(buf);
 	}
 	return 1;
 }
diff -Naur busybox-1.01.orig/procps/Config.in busybox-1.01/procps/Config.in
--- busybox-1.01.orig/procps/Config.in	2005-08-17 03:29:16.000000000 +0200
+++ busybox-1.01/procps/Config.in	2006-03-01 18:04:55.000000000 +0100
@@ -72,7 +72,7 @@
 	  the system has been running, how many users are currently logged
 	  on, and the system load averages for the past 1, 5, and 15 minutes.
 
-config CONFIG_SYSCTL
+config CONFIG_BBOX_SYSCTL
 	bool "sysctl"
 	default n
 	help
diff -Naur busybox-1.01.orig/procps/Makefile.in busybox-1.01/procps/Makefile.in
--- busybox-1.01.orig/procps/Makefile.in	2005-08-17 03:29:16.000000000 +0200
+++ busybox-1.01/procps/Makefile.in	2006-03-01 18:04:55.000000000 +0100
@@ -29,7 +29,7 @@
 PROCPS-$(CONFIG_PIDOF)		+= pidof.o
 PROCPS-$(CONFIG_PS)		+= ps.o
 PROCPS-$(CONFIG_RENICE)		+= renice.o
-PROCPS-$(CONFIG_SYSCTL)		+= sysctl.o
+PROCPS-$(CONFIG_BBOX_SYSCTL)		+= sysctl.o
 PROCPS-$(CONFIG_TOP)		+= top.o
 PROCPS-$(CONFIG_UPTIME)		+= uptime.o
 
diff -Naur busybox-1.01.orig/sysdeps/linux/Config.in busybox-1.01/sysdeps/linux/Config.in
--- busybox-1.01.orig/sysdeps/linux/Config.in	2005-08-17 03:29:15.000000000 +0200
+++ busybox-1.01/sysdeps/linux/Config.in	2006-03-01 18:01:39.000000000 +0100
@@ -203,6 +203,14 @@
 	  if you want to add some simple compiler switches (like -march=i686),
 	  or check for warnings using -Werror, just those options here.
 
+config CONFIG_AUTH_IN_VAR_ETC
+       bool "Search auth files in /var/etc"
+       default n
+       help
+         passwd, shadow, group, gshadow, and nologin will be searched in
+         /var/etc instead of /etc. This is usefull, if /etc is not
+         writeable (flash). 
+
 endmenu
 
 menu 'Installation Options'
diff -Naur busybox-1.01.orig/sysdeps/linux/defconfig busybox-1.01/sysdeps/linux/defconfig
--- busybox-1.01.orig/sysdeps/linux/defconfig	2005-08-17 03:29:15.000000000 +0200
+++ busybox-1.01/sysdeps/linux/defconfig	2006-03-01 18:04:56.000000000 +0100
@@ -266,7 +266,7 @@
 # CONFIG_RX is not set
 CONFIG_STRINGS=y
 CONFIG_TIME=y
-# CONFIG_WATCHDOG is not set
+# CONFIG_BBOX_WATCHDOG is not set
 
 #
 # Linux Module Utilities
@@ -333,7 +333,7 @@
 # CONFIG_RENICE is not set
 # CONFIG_TOP is not set
 CONFIG_UPTIME=y
-# CONFIG_SYSCTL is not set
+# CONFIG_BBOX_SYSCTL is not set
 
 #
 # Another Bourne-like Shell
